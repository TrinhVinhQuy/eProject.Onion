@{
    ViewData["Title"] = "Xác thực email";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section Styles {
    <link rel="stylesheet" href="~/assets/css/css_Login.css" />
}
<div class="m-auto">
    <div class="login-form">
        <h2 class="text-center mb-4">Xác thực </h2>
        <div class="mb-3">
            <label class="form-label">Email</label>
            <input class="form-control" name="email" placeholder="Nhập email" />
        </div>
        <center id="next">
            <a href="javascript:void(0)" id="btnAccuracy" class="site-btn">Gữi</a>
        </center>
    </div>
</div>
<br />
@section Scripts {
    <script>
        function isValidEmail(email) {
            // Biểu thức chính quy để kiểm tra địa chỉ email
            const emailRegex = /^[a-zA-Z0-9._%+-]+@@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

            // Sử dụng test() để kiểm tra xem email có khớp với biểu thức chính quy hay không
            return emailRegex.test(email);
        }
        $('#btnAccuracy').click(function () {
            var email = $("input[name='email']").val();
            if (isValidEmail(email)) {
                $("#btnAccuracy").hide();
                $.ajax({
                    type: "POST",
                    url: "/quen-mat-khau",
                    data: { email: email },
                    success: function (response) {
                        if (response.success) {
                            // $("input[name='email']").prop('disabled', true);
                            showAlertModal('success', response.message);
                        } else {
                            showAlertModal('danger', response.message);
                            $("#btnAccuracy").show();
                        }
                    },
                    error: function (xhr, status, error) {
                        // Xử lý lỗi (nếu có)
                        console.error("Error:", error);
                    }
                });

            }
            else {
                showAlertModal('danger', 'Email không đúng định dạng!');
            }
        });
    </script>
}
